<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CRM Analytics Dashboard</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="logo">CRM Analytics Dashboard</div>
    </header>

    <!-- Tab Navigation -->
    <div class="tab-navigation">
      <button class="tab-button active" data-tab="opportunities">Opportunities</button>
      <button class="tab-button" data-tab="sales-orders">Sales Orders</button>
    </div>

    <!-- Opportunities Tab Content -->
    <div id="opportunities-tab" class="tab-content active">
      <!-- Opportunities KPIs -->
      <div class="kpi-cards">
        <div class="kpi-card">
          <h3>Total Opportunities Created (YTD)</h3>
          <div class="kpi-value" id="totalOppYtd">Count: 0, Value: N/A</div>
          <div class="kpi-trend">Year to Date</div>
        </div>
        <div class="kpi-card">
          <h3>Active Opportunities (Last 24hrs)</h3>
          <div class="kpi-value" id="activeOpp24Hrs">Count: 0, Value: N/A</div>
          <div class="kpi-trend">Created in last 24 hours</div>
        </div>
        <div class="kpi-card">
          <h3>Lost Opportunities (Last 24hrs)</h3>
          <div class="kpi-value" id="lostOpp24Hrs">Count: 0, Value: N/A</div>
          <div class="kpi-trend trend-down">Opportunities lost in last 24 hours</div>
        </div>
        <div class="kpi-card">
          <h3>Won Opportunities (Last 24hrs)</h3>
          <div class="kpi-value" id="wonOpp24Hrs">Count: 0, Value: N/A</div>
          <div class="kpi-trend trend-up">Opportunities won in last 24 hours</div>
        </div>
        <div class="kpi-card">
          <h3>Closure Rate (Last 24hrs)</h3>
          <div class="kpi-value" id="closureRate24Hrs">0%</div>
          <div class="kpi-trend">Closed/Won vs Total (Last 24hrs)</div>
        </div>
      </div>

      <!-- Opportunities Filter -->
      <div class="filter-section">
        <span>Date Range:</span>
        <select id="oppDateRange">
          <option>Last 7 Days</option>
          <option>Last 30 Days</option>
          <option selected>Last Quarter</option>
          <option>Last Year</option>
          <option>Custom Range</option>
        </select>
      </div>

      <!-- Opportunities Charts -->
      <div class="full-width-chart">
        <div class="chart-container">
          <h2>Opportunity Trends Over Time</h2>
          <div class="chart-wrapper">
            <canvas id="trendChart"></canvas>
          </div>
        </div>
      </div>

      <!-- First Row of Charts -->
      <div class="charts-grid">
        <div class="chart-container">
          <h2>Product Performance by Category</h2>
          <div class="chart-wrapper">
            <canvas id="productCategoryChart"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <h2>Service Performance by Category</h2>
          <div class="chart-wrapper">
            <canvas id="serviceCategoryChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Second Row of Charts -->
      <div class="charts-grid">
        <div class="chart-container">
          <h2>Services vs Products Comparison</h2>
          <div class="chart-wrapper">
            <canvas id="servicesVsProductsChart"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <h2>Opportunities by Status Stage</h2>
          <div class="chart-wrapper">
            <canvas id="stageChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Third Row of Charts -->
      <div class="charts-grid">
        <div class="chart-container">
          <h2>Top Performing Products</h2>
          <div class="chart-wrapper">
            <canvas id="topProductsChart"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <h2>Top Performing Services</h2>
          <div class="chart-wrapper">
            <canvas id="topServicesChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Performance by Sales Person Chart (Full Width Row) -->
      <div class="full-width-chart">
        <div class="chart-container">
          <h2>Performance by Sales Person</h2>
          <div class="chart-wrapper">
            <canvas id="salesPersonChart"></canvas>
          </div>
        </div>
      </div>

      <div class="table-container">
        <h2>Recent Opportunities</h2>
        <table>
          <thead>
            <tr>
              <th>Opportunity ID</th>
              <th>Date</th>
              <th>Customer</th>
              <th>Assigned To</th>
              <th>Status</th>
              <th>Age (Days)</th>
              <th>Products</th>
              <th>Services</th>
            </tr>
          </thead>
          <tbody id="opportunitiesTableBody">
            <!-- Rows will be populated by JS -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Sales Orders Tab Content (Restored to Original) -->
    <div id="sales-orders-tab" class="tab-content">
      <!-- Sales Orders KPIs -->
      <div class="kpi-cards">
        <div class="kpi-card">
          <h3>Total Order Value</h3>
          <div class="kpi-value">$284.5K</div>
          <div class="kpi-trend trend-up">↑ 12% vs last period</div>
        </div>
        <div class="kpi-card">
          <h3>Orders This Month</h3>
          <div class="kpi-value">47</div>
          <div class="kpi-trend trend-up">↑ 8%</div>
        </div>
        <div class="kpi-card">
          <h3>Average Order Value</h3>
          <div class="kpi-value">$6,053</div>
          <div class="kpi-trend trend-up">↑ 5%</div>
        </div>
        <div class="kpi-card">
          <h3>Revenue Growth</h3>
          <div class="kpi-value">18%</div>
          <div class="kpi-trend trend-up">↑ 3%</div>
        </div>
        <div class="kpi-card">
          <h3>Customer Retention</h3>
          <div class="kpi-value">87%</div>
          <div class="kpi-trend trend-up">↑ 2%</div>
        </div>
      </div>

      <!-- Sales Orders Filter -->
      <div class="filter-section">
        <span>Date Range:</span>
        <select id="ordersDateRange">
          <option>Last 7 Days</option>
          <option>Last 30 Days</option>
          <option selected>Last Quarter</option>
          <option>Last Year</option>
          <option>Custom Range</option>
        </select>
      </div>

      <!-- Sales Orders Full Width Trend Chart -->
      <div class="full-width-chart">
        <div class="chart-container">
          <h2>Sales Order Trends</h2>
          <div class="chart-wrapper">
            <canvas id="ordersTrendChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Sales Orders Charts Grid -->
      <div class="charts-grid">
        <div class="chart-container">
          <h2>Orders by Status</h2>
          <div class="chart-wrapper">
            <canvas id="ordersStatusChart"></canvas>
          </div>
          <div class="chart-legend" id="ordersStatusLegend"></div>
        </div>

        <div class="chart-container">
          <h2>Top Selling Products</h2>
          <div class="chart-wrapper">
            <canvas id="topProductsChartSO"></canvas>
          </div>
        </div>

        <div class="chart-container">
          <h2>Service Performance</h2>
          <div class="chart-wrapper">
            <canvas id="servicesChartSO"></canvas>
          </div>
          <div class="chart-legend" id="servicesLegendSO"></div>
        </div>

        <div class="chart-container">
          <h2>Sales Performance by Rep</h2>
          <div class="chart-wrapper">
            <canvas id="ordersRepChartSO"></canvas>
          </div>
        </div>
      </div>

      <!-- Sales Orders Table -->
      <div class="table-container">
        <h2>Recent Sales Orders</h2>
        <table>
          <thead>
            <tr>
              <th>Order #</th>
              <th>Date</th>
              <th>Customer</th>
              <th>Assigned To</th>
              <th>Status</th>
              <th>Items</th>
              <th>Total Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>SO-2025-0482</td>
              <td>21/10/2025</td>
              <td>Global Tech Inc</td>
              <td>David Chen</td>
              <td><span class="status-badge status-shipped">Shipped</span></td>
              <td>3</td>
              <td>$18,450</td>
            </tr>
            <tr>
              <td>SO-2025-0481</td>
              <td>20/10/2025</td>
              <td>Nexus Solutions</td>
              <td>Sarah Jones</td>
              <td><span class="status-badge status-delivered">Delivered</span></td>
              <td>2</td>
              <td>$12,800</td>
            </tr>
            <tr>
              <td>SO-2025-0480</td>
              <td>19/10/2025</td>
              <td>Inghb Corporation</td>
              <td>Maria Garcia</td>
              <td><span class="status-badge status-pending">Pending</span></td>
              <td>5</td>
              <td>$24,300</td>
            </tr>
            <tr>
              <td>SO-2025-0479</td>
              <td>18/10/2025</td>
              <td>Beta Systems</td>
              <td>David Chen</td>
              <td><span class="status-badge status-processing">Processing</span></td>
              <td>1</td>
              <td>$8,950</td>
            </tr>
            <tr>
              <td>SO-2025-0478</td>
              <td>17/10/2025</td>
              <td>Alpha Enterprises</td>
              <td>Tom Wilson</td>
              <td><span class="status-badge status-shipped">Shipped</span></td>
              <td>4</td>
              <td>$15,200</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Developer Notes Section -->
    <div class="dev-notes-section">
      <h2>Developer Notes & Implementation Details</h2>
      <div class="dev-notes-content">
        <div class="note-card">
          <h3>📊 Chart Implementation</h3>
          <ul>
            <li>Using Chart.js v4.4.0 via CDN</li>
            <li>All charts are responsive and maintain aspect ratio</li>
            <li>Custom tooltips formatted for currency display where applicable</li>
            <li>Doughnut/pie charts show percentage distribution</li>
            <li>Opportunity Trends chart shows count over time.</li>
            <li>Bar charts used for comparisons and counts.</li>
          </ul>
        </div>

        <div class="note-card">
          <h3>🎨 Design System</h3>
          <ul>
            <li>CSS variables for consistent theming</li>
            <li>Color scheme: Primary (#4361ee), Secondary (#4cc9f0)</li>
            <li>Responsive grid layout with CSS Grid & Flexbox</li>
            <li>Mobile-first approach with media queries</li>
          </ul>
        </div>

        <div class="note-card">
          <h3>🧮 Opportunities Data Computation Methods</h3>
          <ul>
            <li><strong>Total Opportunities Created (YTD):</strong> COUNT(Opportunities created between Jan 1st and
              today's date) = <span id="calcTotalOppYtd">PLACEHOLDER</span>, Value: N/A (No monetary value in sample
              payload)</li>
            <li><strong>Active Opportunities (Last 24hrs):</strong> COUNT(Opportunities created between now and 24 hours
              ago) = <span id="calcActiveOpp24Hrs">PLACEHOLDER</span>, Value: N/A (No monetary value in sample payload)
            </li>
            <li><strong>Closure Rate (Last 24hrs):</strong> (COUNT(Opportunities with status 'Closed Won' in last 24hrs)
              / COUNT(Total Opportunities in last 24hrs)) * 100 = <span id="calcClosureRate24Hrs">PLACEHOLDER</span>%
            </li>
            <li><strong>Lost Opportunities (Last 24hrs):</strong> COUNT(Opportunities with status 'Lost' in last 24hrs)
              = <span id="calcLostOpp24Hrs">PLACEHOLDER</span>, Value: N/A (No monetary value in sample payload)</li>
            <li><strong>Won Opportunities (Last 24hrs):</strong> COUNT(Opportunities with status 'Closed Won' in last
              24hrs) = <span id="calcWonOpp24Hrs">PLACEHOLDER</span>, Value: N/A (No monetary value in sample payload)
            </li>
            <li><strong>Product Performance by Category:</strong> COUNT(Opportunities containing products in each
              category).</li>
            <li><strong>Service Performance by Category:</strong> COUNT(Opportunities containing services in each
              category).</li>
            <li><strong>Services vs Products Comparison:</strong> COUNT(Total Opportunities with at least one product)
              vs COUNT(Total Opportunities with at least one service).</li>
            <li><strong>Top Performing Products:</strong> COUNT(Occurrences of each unique product name across all
              opportunities).</li>
            <li><strong>Top Performing Services:</strong> COUNT(Occurrences of each unique service name across all
              opportunities).</li>
          </ul>
        </div>

        <div class="note-card">
          <h3>👥 Sales Person Analysis</h3>
          <ul>
            <li>Performance tracking by assigned sales representative</li>
            <li>Opportunity count attribution to individual team members</li>
            <li>Deal stage progression analysis per sales person</li>
            <li>Win rate calculation at individual level</li>
            <li>Average deal size comparison across team</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>

</html>